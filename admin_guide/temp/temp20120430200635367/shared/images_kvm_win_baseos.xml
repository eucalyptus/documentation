<?xml version="1.0" encoding="utf-8"?><?workdir /Users/scottb/Documents/git/documentation/admin_guide/temp/temp20120430200635367/shared?><?path2project ../?><task xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="images_kvm_win_baseos" ditaarch:DITAArchVersion="1.2" domains="(topic task)                            (topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)                            (topic task strictTaskbody-c)    " class="- topic/topic task/task " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="task:1">
	<title class="- topic/title " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="title:1">Install Base Windows OS</title>
	<shortdesc class="- topic/shortdesc " xtrc="shortdesc:1" xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita"/>
	<prolog class="- topic/prolog "><copyright class="- topic/copyright " xtrc="copyright:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
			<copyryear class="- topic/copyryear " xtrc="copyryear:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap" year="2012"/>
			<copyrholder class="- topic/copyrholder " xtrc="copyrholder:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">Eucalyptus Systems</copyrholder>
		</copyright><metadata class="- topic/metadata "><prodinfo class="- topic/prodinfo " xtrc="prodinfo:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
			<prodname class="- topic/prodname " xtrc="prodname:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">Eucalyptus</prodname>
			<vrmlist class="- topic/vrmlist " xtrc="vrmlist:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap">
				<vrm class="- topic/vrm " version="3.0" xtrc="vrm:1" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap"/>
			</vrmlist>
		</prodinfo></metadata></prolog><taskbody class="- topic/body task/taskbody " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="taskbody:1">
		<context class="- topic/section task/context " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="context:1">
			
			<p class="- topic/p " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="p:1">The first task for creating a Windows image is installing a base Windows operating system (OS). To
				install a base Windows OS:</p>
		</context>
		<steps class="- topic/ol task/steps " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="steps:1">
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:1">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:1">Log in to the stopped NC server or a host that runs the same hypervisor as the NCs.</cmd>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:2">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:2">Create a blank disk file. Specify your Windows VM image name using the parameter <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:1">of</codeph>.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:1">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:1">dd if=/dev/zero of=windows.&lt;image_name&gt;.img bs=1M count=1 seek=16999</codeblock>
					<note type="important" class="- topic/note " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="note:1">Your image name must start with the word, <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:2">windows</codeph> (all
						lower-case).</note>
				</info>
			</step>
			<step id="kvm_win_secondary_disk" class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:3">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:3">Create a floppy and secondary blank disk to be attached to the image later, in order to test paravirtualization drivers</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:2">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:2">dd if=/dev/zero of=floppy.img \
	bs=1k count=1474
	dd if=/dev/zero of=secondary.img \
	bs=1M count=1 seek=1000</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:4">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:4">Make available the .iso file that contains your Windows installation CD/DVD, then copy the
					.iso file to your working directory (<filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="filepath:1">/usr/share/eucalyptus/doc/</filepath>).</cmd>
				
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:5">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:5">Copy the <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="filepath:2">libvirt-kvm-windows-example.xml</filepath> file to your working
					directory and rename it to <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="filepath:3">libvirt-kvm-windows.xml</filepath>.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:3">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:3">cp libvirt-kvm-windows-example.xml /usr/share/eucalyptus/doc/libvirt-kvm-windows.xml</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:6">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:6">Open the new <filepath class="+ topic/ph sw-d/filepath " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="filepath:4">libvirt-kvm-windows.xml</filepath> file and provide
					fully qualified paths to the VM image file and iso. Make sure that the name of the bridge is the same as the one used by the hypervisor on which you are creating the Windows image.</cmd>
				
				<stepresult class="- topic/itemgroup task/stepresult " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="stepresult:1">
					<p class="- topic/p " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="p:2">Your file should look similar to this example:</p>
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:4">&lt;domain type='kvm'&gt;
	  &lt;name&gt;eucalyptus-windows&lt;/name&gt;
    &lt;os&gt;
    &lt;type&gt;hvm&lt;/type&gt;
    &lt;boot dev='cdrom'/&gt;
    &lt;/os&gt;
    &lt;features&gt;
        &lt;acpi/&gt;
    &lt;/features&gt;
    &lt;memory&gt;524288&lt;/memory&gt;
    &lt;vcpu&gt;1&lt;/vcpu&gt;
    &lt;devices&gt;
        &lt;emulator&gt;/usr/bin/kvm&lt;/emulator&gt;
        &lt;disk type='file'&gt;
            &lt;source file='/root/windows_2003.img'/&gt;
            &lt;target dev='hda'/&gt;
        &lt;/disk&gt;
        &lt;!-- &lt;disk type='file' device='disk'&gt;
             &lt;source file='fully_qualified_path_to_secondary_disk'/&gt;
             &lt;target dev='vda' bus='virtio'/&gt;
        &lt;/disk&gt; 
        &lt;disk type='file' device='floppy'&gt;
             &lt;source file='fully_qualified_path_to_floppy_disk'/&gt;
             &lt;target dev='fda'/&gt;
        &lt;/disk&gt; --&gt;
        &lt;disk type='file' device='cdrom'&gt;
            &lt;source file='/root/en_win_srv_2003_r2_enterprise_with_sp2_cd1_x13-05460.iso'/&gt;
            &lt;target dev='hdc'/&gt;
            &lt;readonly/&gt;
        &lt;/disk&gt;
        &lt;interface type='bridge'&gt;
            &lt;source bridge='br0'/&gt;
            &lt;model type='rtl8139'/&gt;
        &lt;/interface&gt;
        &lt;!--&lt;interface type='bridge'&gt;
            &lt;source bridge='br0'/&gt;
            &lt;model type='virtio'/&gt; 
        &lt;/interface&gt; --&gt;
        &lt;graphics type='vnc' port='-1' autoport='yes' listen='0.0.0.0'/&gt;
    &lt;/devices&gt;
&lt;/domain&gt;</codeblock>
				</stepresult>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:7">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:7">Start the VM.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:4">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:5">virsh create libvirt-kvm-windows.xml</codeblock>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:8">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:8">Connect to the virtual console using the VNC client of your choice. On the NC, check the
					display number that has been allocated by looking at the process table (<codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:3">ps axw | grep vnc</codeph>). For example, if the display number is 0, then connect to the NC using the VNC client:</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:5">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:6">vinagre &lt;machine-hosting-vm&gt;:0</codeblock>
					
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:9">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:9">Follow the standard Windows installation procedure until the VM has completed installing Windows.</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:6">
					<note type="tip" class="- topic/note " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="note:2">On some hosts, the VNCâ€™s display number will change when an image restarts. Use <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:4">ps</codeph> to find the current number.</note>
				</info>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:10">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:10">Run <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:5">virsh</codeph> list to display the domain name.</cmd>
			</step>
			<step class="- topic/li task/step " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="step:11">
				<cmd class="- topic/ph task/cmd " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="cmd:11">Shut down the Windows VM you have just created. The easiest way to shutdown your VM is to
					use the <codeph class="+ topic/ph pr-d/codeph " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeph:6">virsh destroy</codeph> command, as shown:</cmd>
				<info class="- topic/itemgroup task/info " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="info:7">
					<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="codeblock:7">virsh destroy &lt;domain_name&gt;</codeblock>
				</info>
			</step>
		</steps>
		<postreq class="- topic/section task/postreq " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="postreq:1">You are now ready to <xref href="images_kvm_win_wis.xml" class="- topic/xref " xtrf="/Users/scottb/Documents/git/documentation/shared/images_kvm_win_baseos.dita" xtrc="xref:1" type="task"><?ditaot gentext?>Install Eucalyptus Windows Integration<?ditaot genshortdesc?><desc class="- topic/desc "/></xref>.</postreq>
	</taskbody>
<related-links class="- topic/related-links "><linkpool class="- topic/linkpool " xtrc="topicref:116" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap"><link class="- topic/link " mapclass="- map/topicref " type="concept" xtrc="topicref:115" xtrf="/Users/scottb/Documents/git/documentation/ag.ditamap" href="../shared/images_kvm_win.xml" role="parent"><?ditaot usertext?><linktext class="- topic/linktext "><?ditaot gentext?>Create Windows Image (KVM)</linktext><?ditaot genshortdesc?><desc class="- topic/desc "/></link></linkpool></related-links>
</task>